<!DOCTYPE html>
<html class="fullscreen">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="img/apple_icons_57x57.png">
<link rel="apple-touch-icon" sizes="72x72" href="img/apple_icons_72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="img/apple_icons_114x114.png">
<title>Aarav Code Ninjas Photo Gallery | Html Photography Template</title>
<link href="https://fonts.googleapis.com/css?family=Roboto:400,700,400italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css/theme.css" type="text/css" media="all" />
<link rel="stylesheet" href="css/responsive.css" type="text/css" media="all" />
<link rel="stylesheet" href="css/custom.css" type="text/css" media="all" />
</head>
<body>
	<header class="main_header">
    	<div class="header_scroll">
            <div class="header_wrapper">
            	<a href="index.html" class="logo"><img src="img/logo-white-outline.png" alt="" class="logo_def"><img src="img/logo-white-outline.png" alt="" class="logo_retina"></a>                
                <nav>
                	<div class="menu-main-menu-container">
                    	<ul id="menu-main-menu" class="menu">
                        	<li>
                            	<a href="index.html"><span>Home</span></a>                            
                            </li>
                            <li class="menu-item-has-children">
                            	<a href="#"><span>Galleries</span></a>
                                <ul class="sub-menu">
                                    <li><a href="gallery_albums.html"><span>Albums</span></a></li>
                                </ul>
                            </li>
                        </ul>                    
                    </div>
                </nav>            
            </div><!-- Header Wrapper -->
            <div class="footer_wrapper">            
                <div class="socials_wrapper">
                    <ul class="socials_list">
                    	<li><a class="ico_social_facebook" target="_blank" href="http://facebook.com" title="Facebook"></a></li>
                        <li><a class="ico_social_pinterest" target="_blank" href="http://pinterest.com" title="Pinterest"></a></li>
                        <li><a class="ico_social_instagram" target="_blank" href="http://instagram.com" title="Instagram"></a></li>
                        <li><a class="ico_social_flickr" target="_blank" href="http://flickr.com" title="Flickr"></a></li>
                    </ul>
                </div>
                <div class="copyright">Copyright &copy; Code Ninjas.<br>All Rights Reserved</div>
            </div><!-- footer_wrapper -->
    	</div>
	</header>
    
    <div class="fullscreen_block hided">
        <div class="fs_blog_module fw_port_module2 hidden mt7 ml7 sorting_block">
        	<div class="blogpost_preview_fw fw-portPreview element nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/1.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add already_liked">
                            <i class="stand_icon icon-heart"></i>
                            <span>224</span>
                        </div>
                    </div>                    
                </div>
            </div>      
            <div class="blogpost_preview_fw fw-portPreview element fashion portrait pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/2.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>278</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element cities nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/3.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>135</span>
                        </div>
                    </div>                    
                </div>
            </div> 
            <div class="blogpost_preview_fw fw-portPreview element advertisement nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/4.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>61</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element advertisement nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/5.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add already_liked">
                            <i class="stand_icon icon-heart"></i>
                            <span>115</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element cities stuff pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/6.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>91</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element fashion portrait pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/7.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>102</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element advertisement nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/8.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>54</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element nature stuff pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/9.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add already_liked">
                            <i class="stand_icon icon-heart"></i>
                            <span>41</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/10.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>22</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element advertisement cities stuff pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/11.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>32</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element fashion portrait pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/12.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>52</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element advertisement nature stuff pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/13.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>17</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element cities stuff pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/14.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>21</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element advertisement nature pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/15.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>38</span>
                        </div>
                    </div>                    
                </div>
            </div>
            <div class="blogpost_preview_fw fw-portPreview element fashion portrait pr7 pb7">
            	<div class="fw-portPreview-wrapper featured_items">
                    <div class="img_block wrapped_img">
                        <a class="featured_ico_link" href="portfolio_simple_fullwidth_image_post.html">
                            <img alt="" width="540" src="img/portfolio/grid/16.jpg" />
                            <div class="featured_item_fadder"></div>
                        </a>
                        <div class="gallery_likes gallery_likes_add">
                            <i class="stand_icon icon-heart-o"></i>
                            <span>37</span>
                        </div>
                    </div>                    
                </div>
            </div>      
		</div>
	</div> 
    <div class="custom_bg img_bg def_bg"></div>
    <div id="mediaModal" class="modalOverlay">
        <span id="closeModal" class="modalClose">&times;</span>
        <img id="modalImage" class="modal" style="display:none;"/>
        <video id="modalVideo" class="modal" style="display:none;" controls autoplay></video>
    </div>
    <script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui.min.js"></script>    
    <script type="text/javascript" src="js/modules.js"></script>
	<script type="text/javascript" src="js/theme.js"></script>
    <script>
    	// Fetch data from Airtable via PHP proxy (FastComet hosting)
        // This keeps API keys secure on the server side
        var urlParams = new URLSearchParams(window.location.search);
        var albumID = urlParams.get('album');
        window.addEventListener('DOMContentLoaded', function() {
            // Use PHP endpoint (works on FastComet and most shared hosting)
            const apiUrl = '/api/airtable.php';
            
            // Fetch data from our secure proxy
            fetch(apiUrl)
            .then(res => {
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                console.log('Airtable HTTP status:', res.status);
                return res.json();
            })
            .then(data => {
                console.log('Airtable data:', data);
                buildGallery(data);
            })
            .catch(error => {
                console.error('Airtable fetch error:', error);
            });
        });
        function buildGallery(data)
        {
            var $grid = jQuery('.fs_blog_module');
            $grid.empty();
            
            if(!data || !data.records || !Array.isArray(data.records))
        {
            console.error('no records found in data');
            return;
        }
        for(var i=0; i<data.records.length; i++)
    {

        
        var record = data.records[i];
        if (record.fields.Published !== true)
    {
        continue; // Skip unpublished records
    }
        if (albumID)
    {
        var photoAlbums = record.fields.Albums || [];
        var belongsToAlbum = false;
        if (Array.isArray(photoAlbums))
    {
            for (var j = 0; j < photoAlbums.length; j++)
        {
            if (photoAlbums[j] === albumID)
        {
            belongsToAlbum = true;
            break;
        }
        }
    }
        if (!belongsToAlbum)
    {
        continue; // Skip photos not in the specified album
    }
    }
        var linkValue = '#';
    var type = record.fields.Type || '';
    var linkField = record.fields.Link || '';
    var typeStr = String(type).toLowerCase();
    var isPhoto = (typeStr === 'photo');
    var isVideo = (typeStr === 'video');
    var isMediaType = isPhoto || isVideo;

    // For photos: use Photo field as main content
    // For videos: use Photo field for thumbnail, Video field for main content
    var imageUrl = '';
    var videoUrl = '';

    // Get thumbnail/image from Photo field
    var photoAttachments = record.fields && record.fields.Photo || [];
    var photoAtt = photoAttachments[0] || {};
    if (photoAtt.thumbnails && photoAtt.thumbnails.large && photoAtt.thumbnails.large.url) {
        imageUrl = photoAtt.thumbnails.large.url;
    } else if (photoAtt.url) {
        imageUrl = photoAtt.url;
    }

    // Get video from Video field if type is video
    if (isVideo) {
        var videoAttachments = record.fields && record.fields.Video || [];
        var videoAtt = videoAttachments[0] || {};
        if (videoAtt.url) {
            videoUrl = videoAtt.url;
        }
    }

    if (typeStr === 'link') {
        linkValue = linkField;
        if (linkValue && !linkValue.startsWith('http://') && !linkValue.startsWith('https://')) {
            linkValue = 'http://' + linkValue;
        }
    }

    // if item is a photo or video, we'll open it in the modal instead of navigating
    if (isMediaType) {
        linkValue = '#';
    }

    // Build HTML item; if media type add a data attribute
    var htmlItem =
        '<div class="blogpost_preview_fw fw-portPreview element nature pr7 pb7">' +
            '<div class="fw-portPreview-wrapper featured_items">' +
                '<div class="img_block wrapped_img">' +
                    '<a class="featured_ico_link" ' + (isMediaType ? ('href="#" data-media-type="' + typeStr + '"') : ('target="_blank" href="' + linkValue + '"')) + '>' +
                        '<img alt="" width="540" src="' + imageUrl + '" />' +
                        '<div class="featured_item_fadder"></div>' +
                    '</a>' +
                '</div>' +
            '</div>' +
        '</div>';

    var $item = jQuery(htmlItem);
    $grid.append($item);

    // If this record is a photo or video, attach click handler to open modal
    if (isMediaType) {
        // For videos, use videoUrl as main content; for photos, use imageUrl
        var mediaContentUrl = isVideo ? videoUrl : imageUrl;
        
        (function(mediaUrl, mediaType){
            $item.find('a.featured_ico_link').on('click', function(e){
                e.preventDefault();
                var $modal = jQuery('#mediaModal');
                var $modalImg = jQuery('#modalImage');
                var $modalVid = jQuery('#modalVideo');
                
                // Clear and hide both
                $modalImg.hide().attr('src', '');
                $modalVid.hide().attr('src', '');
                
                // Show and populate the correct one
                if (mediaType === 'photo') {
                    $modalImg.attr('src', mediaUrl).show();
                } else if (mediaType === 'video') {
                    $modalVid.attr('src', mediaUrl).show();
                }
                
                $modal.addClass('open');
            });
        })(mediaContentUrl, typeStr);
    }
    } 
        };
        
        jQuery(document).ready(function ($) {
			"use strict";
			jQuery('.custom_bg').remove();            
		});       				
	</script>
    <script>
        // Modal close handlers (separate script placed after main gallery code)
        (function(){
            var $modal = jQuery('#mediaModal');
            var $modalImg = jQuery('#modalImage');
            var $modalVid = jQuery('#modalVideo');
            var $close = jQuery('#closeModal');

            function closeModal() {
                $modal.removeClass('open');
                $modalImg.attr('src', '').hide();
                $modalVid.attr('src', '').hide();
                $modalVid.get(0).pause();
            }

            $close.on('click', function(e){
                e.preventDefault();
                closeModal();
            });

            // Clicking the overlay (but not the media) closes the modal
            $modal.on('click', function(e){
                if (e.target === this) {
                    closeModal();
                }
            });

            // Esc key closes modal
            jQuery(document).on('keydown', function(e){
                if (e.key === 'Escape' || e.keyCode === 27) {
                    if ($modal.hasClass('open')) closeModal();
                }
            });
        })();
    </script>
    <script type="text/javascript" src="js/jquery.isotope.min.js"></script>
</body>
</html>